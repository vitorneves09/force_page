!function(e,t){"function"==typeof define&&define.amd?define(["quill"],t):"undefined"!=typeof module&&"object"==typeof exports?module.exports=t(require("quill")):e.Requester=t(e.Quill)}(this,function(p){"use strict";var e;return(e=angular.module("ngQuill",["ngSanitize"])).provider("ngQuillConfig",function(){var t={modules:{toolbar:[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["clean"],["link","image","video"]]},theme:"snow",placeholder:"Insert text here ...",readOnly:!1,bounds:document.body};this.set=function(e){(e=e||{}).modules&&(t.modules=e.modules),e.theme&&(t.theme=e.theme),null!==e.placeholder&&void 0!==e.placeholder&&(t.placeholder=e.placeholder.trim()),e.bounds&&(t.bounds=e.bounds),e.readOnly&&(t.readOnly=e.readOnly),e.formats&&(t.formats=e.formats)},this.$get=function(){return t}}),e.component("ngQuillEditor",{bindings:{modules:"<modules",theme:"@?",readOnly:"<?",format:"@?",formats:"<?",placeholder:"<?",bounds:"<?",scrollingContainer:"<?",strict:"<?",onEditorCreated:"&?",onContentChanged:"&?",onSelectionChanged:"&?",ngModel:"<",maxLength:"<",minLength:"<",customOptions:"<?",styles:"<?",sanitize:"<?",customToolbarPosition:"@?"},require:{ngModelCtrl:"ngModel"},transclude:{toolbar:"?ngQuillToolbar"},template:'<div class="ng-hide" ng-show="$ctrl.ready"><ng-transclude ng-transclude-slot="toolbar"></ng-transclude></div>',controller:["$scope","$element","$sanitize","$timeout","$transclude","ngQuillConfig",function(r,i,o,e,l,t){var s,a,d,h,u,c={},g="html",m=!1,f=!1,n=t.placeholder;this.setter=function(t){if("html"===g)return d.clipboard.convert(this.sanitize?o(t):t);if("json"===this.format)try{return JSON.parse(t)}catch(e){return[{insert:t}]}return t},this.validate=function(e){var t=e.trim().length;this.maxLength&&(t>this.maxLength?this.ngModelCtrl.$setValidity("maxlength",!1):this.ngModelCtrl.$setValidity("maxlength",!0)),0<this.minLength&&(t<this.minLength&&t?this.ngModelCtrl.$setValidity("minlength",!1):this.ngModelCtrl.$setValidity("minlength",!0))},this.$onChanges=function(e){if(e.ngModel&&e.ngModel.currentValue!==e.ngModel.previousValue&&(s=e.ngModel.currentValue,d&&!f&&(m=!0,s?"text"===this.format?d.setText(s):d.setContents(this.setter(s)):d.setText("")),f=!1),d&&e.readOnly&&d.enable(!e.readOnly.currentValue),d&&e.placeholder&&(d.root.dataset.placeholder=e.placeholder.currentValue),d&&a&&e.styles){var t=e.styles.currentValue,n=e.styles.previousValue;if(n)for(var i in n)a.style[i]="";if(t)for(var o in t)t.hasOwnProperty(o)&&(a.style[o]=t[o])}},this.$onInit=function(){null!==this.placeholder&&void 0!==this.placeholder&&(n=this.placeholder.trim()),this.format&&-1<["object","html","text","json"].indexOf(this.format)&&(g=this.format),c={theme:this.theme||t.theme,readOnly:this.readOnly||t.readOnly,modules:this.modules||t.modules,formats:this.formats||t.formats,placeholder:n,bounds:this.bounds||t.bounds,strict:this.strict,scrollingContainer:this.scrollingContainer}},this.$postLink=function(){e(function(){this._initEditor()}.bind(this),0)},this.$onDestroy=function(){d=null,h&&h.removeListener("text-change"),u&&u.removeListener("selection-change")},this._initEditor=function(){var e=angular.element("<div></div>"),t=i.children();if(a=e[0],"self"===c.bounds&&(c.bounds=a),l.isSlotFilled("toolbar")&&(c.modules.toolbar=t.find("ng-quill-toolbar").children()[0]),this.styles)for(var n in this.styles)this.styles.hasOwnProperty(n)&&(a.style[n]=this.styles[n]);if(this.customToolbarPosition&&"top"!==this.customToolbarPosition?t.prepend(e):t.append(e),this.customOptions&&this.customOptions.forEach(function(e){var t=p.import(e.import);t.whitelist=e.whitelist,e.toRegister&&(t[e.toRegister.key]=e.toRegister.value),p.register(t,!0)}),d=new p(a,c),this.ready=!0,u=d.on("selection-change",function(e,t,n){this.onSelectionChanged&&this.onSelectionChanged({editor:d,oldRange:t,range:e,source:n}),e||r.$applyAsync(function(){this.ngModelCtrl.$setTouched()}.bind(this))}.bind(this)),h=d.on("text-change",function(e,t,n){var i=a.children[0].innerHTML,o=d.getText(),l=d.getContents(),s=["<"+d.root.firstChild.localName+">","</"+d.root.firstChild.localName+">"];i===s[0]+"<br>"+s[1]&&(i=null),this.validate(o),m||r.$applyAsync(function(){if(f=!0,"user"===n)if("text"===g)this.ngModelCtrl.$setViewValue(o);else if("object"===g)this.ngModelCtrl.$setViewValue(l);else if("json"===this.format)try{this.ngModelCtrl.$setViewValue(JSON.stringify(l))}catch(e){this.ngModelCtrl.$setViewValue(o)}else this.ngModelCtrl.$setViewValue(i);this.onContentChanged&&this.onContentChanged({editor:d,html:i,text:o,content:l,delta:e,oldDelta:t,source:n})}.bind(this)),m=!1}.bind(this)),s){if(m=!0,"text"===g)d.setText(s,"silent");else if("object"===g)d.setContents(s,"silent");else if("json"===g)try{d.setContents(JSON.parse(s),"silent")}catch(e){d.setText(s,"silent")}else d.setContents(d.clipboard.convert(this.sanitize?o(s):s,"silent"));d.history.clear()}this.onEditorCreated&&this.onEditorCreated({editor:d})}}]}),e.name});